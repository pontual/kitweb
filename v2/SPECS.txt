FILE STRUCTURE

index.php
login.php


TABLES

[updates should be done in order below]

v2_administrador

EMAIL [varchar(100)]
SENHA (bcrypt varchar (see PHP docs)) (if "", redirect to page to make a password)

v2_ficha


v2_produto



v2_categoria

ID [int]

ETIQUETAS [textarea]
  [newline-separated list]
  
CODIGOS [textarea]
  [newline-separated list] (like existing table categorias)

v2_item_menu

ID [int]

ETIQUETA [varchar(50)]

SUBITENS [textarea]
  [newline-separated list of categorias ids]
  (if subitens is a single id, the item_menu becomes a direct link)





AUTH

http://stackoverflow.com/questions/1243150/php-sessions-to-authenticate-user-on-login-form

// setup session

session_start();
if( isset($_POST['username']) && isset($_POST['password']) )
{
    if( auth($_POST['username'], $_POST['password']) )
    {
        // auth okay, setup session
        $_SESSION['user'] = $_POST['username'];
        // redirect to required page
        header( "Location: index.php" );
     } else {
        // didn't auth go back to login
        header( "Location: login.html" );
     }
 } else {
     // username and password not given so go back to login
     header( "Location: login.html" );
 }

// For secure pages

session_start();
session_regenerate_id();
if(!isset($_SESSION['user']))      // if there is no valid session
{
    header("Location: login.html");
}

// Logout

session_start();
unset($_SESSION['user']);
session_destroy();
header("Location: login.html");
